---
description: 
globs: features/**/*.feature,features/**/*.steps.ts,features/**/*.steps.tsx
alwaysApply: false
---
- Each `.feature` file must have a corresponding `.steps.ts` test file
- Use `jest-cucumber` to write test flows
- Step definitions must include `given`, `when`, `then`
- Each `step` should use explicit variable naming (e.g., `username`, `password`, `result`)
- Tests should use `jest.fn()` to create mock functions (e.g., `mockLogin = jest.fn(login)`)
- Each scenario should verify:
  - Whether mock functions are called (`toHaveBeenCalledWith()`)
  - Whether mock functions are called only once (`toHaveBeenCalledTimes(1)`)
  - Correct return results (`toBe(...)`)
- Each test file should include `beforeEach()` and clear mock state (`jest.clearAllMocks()`)
- Use data-testid to capture controls
- Error messages should be verified using `screen.getByText(...)` or `getByTestId(...)`
- All field operations should use `userEvent.type` or `clear`
- UI tests should wrap async result verification with `waitFor`
- Must include at least:
  - Success scenarios
  - Error scenarios (invalid credentials)
  - Boundary scenarios (empty values)
